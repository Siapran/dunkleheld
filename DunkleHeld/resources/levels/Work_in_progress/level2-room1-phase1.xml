<?xml version="1.0" encoding="UTF-8"?>
<map version="1.0" orientation="orthogonal" width="15" height="15" tilewidth="16" tileheight="16">
	<tileset firstgid="1" name="tiles" tilewidth="16" tileheight="16">
		<image source="../../tilesets/tiles.png" width="96" height="144"/>
	</tileset>
	<layer name="Tiles" width="15" height="15">
		<data>
			<tile gid="4"/>
			<tile gid="5"/>
			<tile gid="5"/>
			<tile gid="5"/>
			<tile gid="5"/>
			<tile gid="6"/>
			<tile gid="4"/>
			<tile gid="5"/>
			<tile gid="46"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="45"/>
			<tile gid="5"/>
			<tile gid="5"/>
			<tile gid="6"/>
			<tile gid="10"/>
			<tile gid="11"/>
			<tile gid="11"/>
			<tile gid="11"/>
			<tile gid="11"/>
			<tile gid="12"/>
			<tile gid="10"/>
			<tile gid="11"/>
			<tile gid="52"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="51"/>
			<tile gid="11"/>
			<tile gid="11"/>
			<tile gid="12"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="45"/>
			<tile gid="46"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="22"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="34"/>
			<tile gid="0"/>
			<tile gid="51"/>
			<tile gid="52"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="4"/>
			<tile gid="5"/>
			<tile gid="5"/>
			<tile gid="38"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="10"/>
			<tile gid="11"/>
			<tile gid="11"/>
			<tile gid="52"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="21"/>
			<tile gid="21"/>
			<tile gid="21"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="27"/>
			<tile gid="27"/>
			<tile gid="27"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="16"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="18"/>
			<tile gid="22"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="34"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="33"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="23"/>
			<tile gid="24"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="40"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="0"/>
			<tile gid="39"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="8"/>
			<tile gid="8"/>
		</data>
	</layer>
	<objectgroup name="props" width="0" height="0">

		<link x="96"	y="224"	width="48"	height="16" id="1">
			<trigger exp="has_crystal" id="1">
				<then>
					<destination file="main_hall_phase2" x1="144" y1="64" x2="96" y2="32" id="1"/>
				</then>
				<else>
					<destination file="main_hall_phase1" x="112" y="0" id="2"/>
				</else>
			</trigger></link>
		<link x="144"	y="0"	width="32"	height="16" id="2">
			<trigger exp="has_crystal" id="2">
				<then>
					<destination file="level2-room2-phase1" x1="144" y1="176" x2="144" y2="208" id="3"/>
				</then>
				<else>
					<destination file="level2-room2-phase1" x="144" y="224" id="4"/>
				</else>
			</trigger>
		</link>

		<prop name="statue_b"		x="80"	y="96"	width="32"	height="32" id="1">
			<trigger exp="has_crystal" id="3">
				<then>
					<action target="statue_b#1" value="statue_b_red" id="1"/>
					<action target="statue_b#2" value="statue_b_red" id="13"/>
					<action target="statue_b#3" value="statue_b_red" id="14"/>
					<action target="statue_b#4" value="statue_b_red" id="15"/>
				</then>
				<else>
					<action target="statue_b#1" value="statue_b_blue" id="2"/>
					<action target="statue_b#2" value="statue_b_blue" id="16"/>
					<action target="statue_b#3" value="statue_b_blue" id="17"/>
					<action target="statue_b#4" value="statue_b_blue" id="18"/>
				</else>
			</trigger></prop>
		<prop name="statue_b"		x="176"	y="48"	width="32"	height="32" id="2"/>
		<prop name="statue_b"		x="160"	y="112"	width="32"	height="32" id="3"/>
		<prop name="statue_b"		x="160"	y="176"	width="32"	height="32" id="4"/>

		<prop name="pylon"			x="64"	y="128"	width="16"	height="16">
			<trigger exp="switch.state == on" id="4">
				<then>
					<action target="pylon#1" value="pylon_on" id="3"/>
					<action target="pylon#2" value="pylon_on" id="4"/>
				</then>
				<else>
					<action target="pylon#1" value="pylon_off" id="5"/>
					<action target="pylon#2" value="pylon_on" id="6"/>
				</else>
			</trigger></prop>
		<prop name="pylon"			x="64"	y="128"	width="16"	height="16"/>

		<prop name="switch"			x="16"	y="192"	width="16"	height="16" state="off" />

		<prop name="pressure_plate"	x="24"	y="40"	width="16"	height="16"	id="1">
			<trigger exp="pressure_plate#1:pressure_plate_on" id="5">
				<setvar scope="local" target="lv2_room1_press1" value="pressure_plate#1.state == on" id="1"/>
			</trigger></prop>
		<prop name="pressure_plate"	x="24"	y="120"	width="16"	height="16"	id="2">
			<trigger exp="pressure_plate#2:pressure_plate_on" id="6">
				<setvar scope="local" target="lv2_room1_press2" value="pressure_plate#2.state == on" id="2"/>
				<setvar scope="local" target="lv2_room1_solved" value="(lv2_room1_press1 & lv2_room1_press2)" id="3"/>
			</trigger></prop>

		<prop name="spikes"			x="96"	y="208"	width="16"	height="16" id="1">
			<trigger exp="!(has_crystal) | (lv2_room1_solved)" id="7">
				<then>
					<action target="spikes#1" value="spikes_off" id="7"/>
					<action target="spikes#2" value="spikes_off" id="8"/>
					<action target="spikes#3" value="spikes_off" id="9"/>
				</then>
				<else>
					<action target="spikes#1" value="spikes_on" id="10"/>
					<action target="spikes#2" value="spikes_on" id="11"/>
					<action target="spikes#3" value="spikes_on" id="12"/>
				</else>
			</trigger></prop>
		<prop name="spikes"			x="112"	y="208"	width="16"	height="16" id="2"/>
		<prop name="spikes"			x="128"	y="208"	width="16"	height="16" id="3"/>

		<prop name="pebbles"		x="128"	y="80"	width="16"	height="16"	state="frame1" id="1"/>
		<prop name="pebbles"		x="112"	y="144"	width="16"	height="16"	state="frame3" id="2"/>
		<prop name="pebbles"		x="208"	y="96"	width="16"	height="16"	state="frame2" id="3"/>
		<prop name="pebbles"		x="48"	y="32"	width="16"	height="16"	state="frame0" id="4"/>
		<prop name="pebbles"		x="48"	y="176"	width="16"	height="16"	state="frame1" id="5"/>
	</objectgroup>
</map>
